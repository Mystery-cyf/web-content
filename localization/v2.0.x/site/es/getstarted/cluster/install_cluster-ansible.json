{"codeList":["$ git clone https://github.com/milvus-io/milvus.git\n","$ cd ./milvus/deployments/docker/cluster-distributed-deployment\n","[dockernodes] #Add docker host names.\ndockernode01\ndockernode02\ndockernode03\n\n[admin] #Add Ansible controller name.\nansible-controller\n\n[coords] #Add the host names of Milvus coordinators.\n; Take note the IP of this host VM, and replace 10.170.0.17 with it.\ndockernode01\n\n[nodes] #Add the host names of Milvus nodes.\ndockernode02\n\n[dependencies] #Add the host names of Milvus dependencies.\n; dependencies node will host etcd, minio, pulsar, these 3 roles are the foundation of Milvus. \n; Take note the IP of this host VM, and replace 10.170.0.19 with it.\ndockernode03\n\n[docker:children]\ndockernodes\ncoords\nnodes\ndependencies\n\n[docker:vars]\nansible_python_interpreter= /usr/bin/python3\nStrictHostKeyChecking= no\n\n; Setup variables to controll what type of network to use when creating containers.\ndependencies_network= host\nnodes_network= host\n\n; Setup varibale to controll what version of Milvus image to use.\nimage= milvusdb/milvus-dev:master-20220412-4781db8a\n\n; Setup static IP addresses of the docker hosts as variable for container environment variable config.\n; Before running the playbook, below 4 IP addresses need to be replaced with the IP of your host VM\n; on which the etcd, minio, pulsar, coordinators will be hosted.\netcd_ip= 10.170.0.19\nminio_ip= 10.170.0.19\npulsar_ip= 10.170.0.19\ncoords_ip= 10.170.0.17\n\n; Setup container environment which later will be used in container creation.\nETCD_ENDPOINTS= {{etcd_ip}}:2379 \nMINIO_ADDRESS= {{minio_ip}}:9000\nPULSAR_ADDRESS= pulsar://{{pulsar_ip}}:6650\nQUERY_COORD_ADDRESS= {{coords_ip}}:19531\nDATA_COORD_ADDRESS= {{coords_ip}}:13333\nROOT_COORD_ADDRESS= {{coords_ip}}:53100\nINDEX_COORD_ADDRESS= {{coords_ip}}:31000\n","[defaults]\nhost_key_checking = False\ninventory = inventory.ini # Specify the Inventory file\nprivate_key_file=~/.my_ssh_keys/gpc_sshkey # Specify the SSH key that Ansible uses to access Docker host\n","---\n- name: setup pre-requisites # Install prerequisite\n  hosts: all\n  become: yes\n  become_user: root\n  roles:\n    - install-modules\n    - configure-hosts-file\n\n- name: install docker\n  become: yes\n  become_user: root\n  hosts: dockernodes\n  roles:\n    - docker-installation\n","$ ansible all -m ping\n","dockernode01 | SUCCESS => {\n\"changed\": false,\n\"ping\": \"pong\"\n}\nansible-controller | SUCCESS => {\n    \"ansible_facts\": {\n        \"discovered_interpreter_python\": \"/usr/bin/python3\"\n    },\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\ndockernode03 | SUCCESS => {\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\ndockernode02 | SUCCESS => {\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\n","$ ansible-playbook deploy-docker.yml --syntax-check\n","playbook: deploy-docker.yml\n","$ ansible-playbook deploy-docker.yml\n","TASK [docker-installation : Install Docker-CE] *******************************************************************\nok: [dockernode01]\nok: [dockernode03]\nok: [dockernode02]\n\nTASK [docker-installation : Install python3-docker] **************************************************************\nok: [dockernode01]\nok: [dockernode02]\nok: [dockernode03]\n\nTASK [docker-installation : Install docker-compose python3 library] **********************************************\nchanged: [dockernode01]\nchanged: [dockernode03]\nchanged: [dockernode02]\n\nPLAY RECAP *******************************************************************************************************\nansible-controller         : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\ndockernode01               : ok=10   changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\ndockernode02               : ok=10   changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\ndockernode03               : ok=10   changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n","$ docker -v\n","$ sudo docker -v\n","Docker version 20.10.14, build a224086\n","$ docker ps\n","$ ansible-playbook deploy-milvus.yml --syntax-check\n","playbook: deploy-milvus.yml\n","$ ansible-playbook deploy-milvus.yml\n","PLAY [Create milvus-etcd, minio, pulsar] *****************************************************************\n\nTASK [Gathering Facts] ********************************************************************************************\nok: [dockernode03]\n\nTASK [etcd] *******************************************************************************************************\nchanged: [dockernode03]\n\nTASK [pulsar] *****************************************************************************************************\nchanged: [dockernode03]\n\nTASK [minio] ******************************************************************************************************\nchanged: [dockernode03]\n\nPLAY [Create milvus nodes] ****************************************************************************************\n\nTASK [Gathering Facts] ********************************************************************************************\nok: [dockernode02]\n\nTASK [querynode] **************************************************************************************************\nchanged: [dockernode02]\n\nTASK [datanode] ***************************************************************************************************\nchanged: [dockernode02]\n\nTASK [indexnode] **************************************************************************************************\nchanged: [dockernode02]\n\nPLAY [Create milvus coords] ***************************************************************************************\n\nTASK [Gathering Facts] ********************************************************************************************\nok: [dockernode01]\n\nTASK [rootcoord] **************************************************************************************************\nchanged: [dockernode01]\n\nTASK [datacoord] **************************************************************************************************\nchanged: [dockernode01]\n\nTASK [querycoord] *************************************************************************************************\nchanged: [dockernode01]\n\nTASK [indexcoord] *************************************************************************************************\nchanged: [dockernode01]\n\nTASK [proxy] ******************************************************************************************************\nchanged: [dockernode01]\n\nPLAY RECAP ********************************************************************************************************\ndockernode01               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\ndockernode02               : ok=4    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\ndockernode03               : ok=4    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n","[nodes] #Add host names of Milvus nodes.\ndockernode02\ndockernode04 #This is the host name of the new node.\n","Docker ps -a\n"],"headingContent":"","anchorList":[{"label":"Install Milvus Cluster with Ansible","href":"Install-Milvus-Cluster-with-Ansible","type":1,"isActive":false},{"label":"Prerequisites","href":"Prerequisites","type":2,"isActive":false},{"label":"Set up Ansible admin controller","href":"Set-up-Ansible-admin-controller","type":2,"isActive":false},{"label":"Download Ansible Milvus node deployment Playbook","href":"Download-Ansible-Milvus-node-deployment-Playbook","type":2,"isActive":false},{"label":"Configure installation files","href":"Configure-installation-files","type":2,"isActive":false},{"label":"Test Ansible connectivity","href":"Test-Ansible-connectivity","type":2,"isActive":false},{"label":"Check the Playbook Syntax","href":"Check-the-Playbook-Syntax","type":2,"isActive":false},{"label":"Install Docker","href":"Install-Docker","type":2,"isActive":false},{"label":"Verify the installation","href":"Verify-the-installation","type":2,"isActive":false},{"label":"Check the Syntax","href":"Check-the-Syntax","type":2,"isActive":false},{"label":"Create Milvus container","href":"Create-Milvus-container","type":2,"isActive":false},{"label":"Scale out Milvus nodes","href":"Scale-out-Milvus-nodes","type":2,"isActive":false},{"label":"What's next","href":"Whats-next","type":2,"isActive":false}]}